 " General basic necessary plugins
set nocompatible                "Be iMproved, required
set backspace=indent,eol,start  "Make backspace behave well
syntax on                       "Enable syntax highlighting
filetype plugin indent on       "Enable file type detection and do language-dependent indenting.
so ~/.vim/plugins.vim           " Source the plugins file

"/ gogen ----> GENERAL CONFIG
"/ goplu ----> PLUGINS
"/ gofun ----> FUNCTIONS
"/ gomap ----> MAPPINGS

"/
"/ gogen ----> GENERAL CONFIG
"/

syntax enable
let mapleader = ','
set smartindent
set number
set relativenumber
set tabstop=8
set expandtab
set softtabstop=4                        " Insert mode
set shiftwidth=4                         " Spaces when using < and >
set complete=.,w,b,u                     " Autocomplete looks through current buffer, window, loaded buffers, unloaded buffers
set wildmenu
set wildignore+=*/tmp/*,*.so,*.swp,*.zip
" set nojoinspaces
" set foldmethod=marker

set autoread
runtime! macros/matchit.vim

set mouse=a 

" Map ctrl+s to save
nmap <c-s> :w<CR>
imap <c-s> <Esc>:w<CR>
" Substitute word under the cursor
nnoremap <Leader>s :%s/\<<C-r><C-w>\>//g<Left><Left>



" Move by showed line?
" nmap k gk
" nmap j gj



"------Visuals
colorscheme srcery
" dfferent colorscheme for ruby and markdown, for example
" autocmd FileType ruby colorscheme railcasts

" function! CleanBg()
"     hi Normal ctermbg=NONE
"     hi nonText ctermbg=NONE
"     hi SignColumn ctermbg=NONE
"     hi TabLineFill ctermbg=NONE
" endfunction
" autocmd FileType php colorscheme jellybeans NEED TO RERUN THE BG NONE!

set t_CO=256                             "Use 256 colors
set laststatus=2                         "Always display the status bar
let g:airline_powerline_fonts = 0
let g:airline_theme='aurora'
hi LineNr ctermfg=DarkGrey
hi Normal ctermbg=NONE
hi nonText ctermbg=NONE
hi SignColumn ctermbg=NONE
hi TabLineFill ctermbg=NONE

set nocursorline
set nocursorcolumn

"------Search
set hlsearch
set incsearch
set ignorecase


"------Splits
set splitbelow
set splitright



"/
"/ gofun ----> FUNCTIONS
"/

function! RenameFile()
  let old_name = expand('%')
  let new_name = input('New file name: ', expand('%'), 'file')
  if new_name != '' && new_name != old_name
    exec ':saveas ' . new_name
    exec ':silent !rm ' . old_name
    redraw!
  endif
endfunction

function! IPhpInsertUse()
    call PhpInsertUse()
    call feedkeys('a',  'n')
endfunction

function! IPhpExpandClass()
    call PhpExpandClass()
    call feedkeys('a', 'n')
endfunction



"/
"/ gomap ----> MAPPINGS
"/

" ctrl+s to save
nmap <C-s> :w<CR>

" ctrl+[hjkl] to move between panes
nmap <C-j> <C-w><C-j>
nmap <C-k> <C-w><C-k>
nmap <C-h> <C-w><C-h>
nmap <C-l> <C-w><C-l>

" ctrl+m to increment next number on the line
noremap     <C-m>               <C-a>

noremap     <Space>             :

nmap        <Leader><space>     :nohlsearch<cr>
nnoremap    <Leader>]           :CtrlPTag<cr>
inoremap    <c-x><c-]>          <c-]>
nmap        <Leader>\|          :vsp<cr>
nmap        <Leader>-           :sp<cr>
nmap        <Leader><           :SyntasticToggleMode<cr>
nmap        <Leader>q           :cclose<CR>
nnoremap    <Leader>W           :res +10<CR>
nnoremap    <Leader>w           :res -10<CR>

nmap        <Leader>1           :NERDTreeToggle<cr>
nnoremap    <Leader>2           :TagbarToggle<CR>

" a for ack
nmap        <Leader>aa          :Ack<space>
nnoremap    <Leader>aw          :Ack <C-r><C-w><cr>

"e for edit
nmap        <Leader>ev          :tabedit ~/.vimrc<cr>
nmap        <Leader>ep          :tabedit ~/.vim/plugins.vim<cr>
nmap        <Leader>es          :tabedit ~/.vim/UltiSnips/

" f for file
map         <Leader>fr          :call RenameFile()<cr>

" g for go or git
nnoremap    <Leader>gr          :e bootstrap/routes.php<CR>
nnoremap    <Leader>gg          :Gstatus<CR>

" i for insert
nnoremap    <Leader>id          "=strftime("%Y-%m-%d %H:%M:%S")<CR>P
inoremap    <Leader>id          <C-R>=strftime("%Y-%m-%d %H:%M:%S")<CR>

" n for numbers
map         <Leader>n           :set relativenumber<CR>
map         <Leader>N           :set norelativenumber<CR>

" p for php
inoremap    <Leader>pi          <Esc>:call IPhpInsertUse()<CR>
noremap     <Leader>pi          :call PhpInsertUse()<CR>
inoremap    <Leader>pe          <Esc>:call IPhpExpandClass()<CR>
noremap     <Leader>pe          :call PhpExpandClass()<CR>
noremap     <Leader>ps          :call PhpSortUse()<CR>

" r for replace
nnoremap    <Leader>rw          :%s/\<<C-r><C-w>\>//g<Left><Left>

" s for search
nmap        <Leader>sr          :CtrlPMRUFiles<cr>
nmap        <Leader>st          :CtrlPTag<cr>

" t for test
nnoremap    <silent><leader>tt  :TestNearest<CR>
nnoremap    <silent><leader>tT  :TestFile<CR>
nnoremap    <silent><leader>ta  :TestSuite<CR>
nnoremap    <silent><leader>tl  :TestLast<CR>
nnoremap    <silent><leader>tg  :TestVisit<CR>
nnoremap    <leader>tsb :let test#strategy = 'basic'<CR>
nnoremap    <leader>tsd :let test#strategy = 'dispatch'<CR>






"/
"/ goplu ----> PLUGINS
"/

"/ VimCommentary
autocmd FileType php setlocal commentstring=\/\/\ %s

"/ CtrlP
let g:ctrlp_extensions = ['tag']
let g:ctrlp_match_window = 'top,order:ttb,min:1,max:10,results:10'    " window to the top and other settings
let g:ctrlp_custom_ignore = '\v[\/](\.git|\.hg|node_modules|vendor)$' " ignore package managers huge folders
let g:ctrlp_custom_ignore = '\v[\/](\.git|\.hg|node_modules|vendor)$'

"/ NERDTree
" messing with vinegar...
let NERDTreeHijackNetrw = 0                                           

"/ Elm
let g:elm_format_autosave = 1

"/ VIM Test
" Dispatch to use the quickfix window. I like my terminal
let test#strategy = "dispatch"

"/ AutoPairs
let g:AutoPairsShortcutBackInsert = '<C-b>'

"/ Emmet
" Use ,, to trigger emmet
let g:user_emmet_leader_key=','

"/ UltiSnips
let g:UltiSnipsExpandTrigger="<tab>"
let g:UltiSnipsJumpForwardTrigger="<C-n>"
let g:UltiSnipsJumpBackwardTrigger="<C-p>"

"/ VimAck
let g:ackprg = 'ag --vimgrep'

"/ Syntastic
" set statusline=%<%f\ %h%m%r%{fugitive#statusline()}%=%-14.(%l,%c%V%)\ %P
set statusline+=%#warningmsg#
set statusline+=%{SyntasticStatuslineFlag()}
set statusline+=%*

let g:syntastic_always_populate_loc_list = 1
let g:syntastic_auto_loc_list = 1
let g:syntastic_check_on_open = 1
let g:syntastic_check_on_wq = 0

" PHP
let g:syntastic_php_checkers = ['php', 'phpcs']
let g:syntastic_php_phpcs_args = "--standard=phpcs.xml"
"--exclude=CamelCapsFunctionNameStandard"
" JS
let g:syntastic_javascript_checkers = ['eslint']
let g:syntastic_javascript_eslint_exe = 'eslint %'  " Just lint the current file

"/ VimAck
" Use the silversearcher
let g:ackprg = 'ag --vimgrep'


"/ Autocorrect abbrev
iabbrev ret return
iabbrev rq request
iabbrev rs response
iabbrev reutrn return
iabbrev repsonse response
iabbrev gropu group


"------Auto-Commands
augroup autosourcing
    autocmd!
    autocmd BufWritePost .vimrc source %
augroup END
